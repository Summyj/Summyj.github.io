/* ==================== 深色模式适配 ==================== */

/* 深色模式适配（如果主题支持） */
@media (prefers-color-scheme: dark) {
    /* 只在没有手动设置主题时应用滤镜 */
    :root:not(.theme-dark):not(.theme-light) .not-by-ai-sidebar img {
        filter: brightness(0.9);
    }
    
    /* 确保文章内容在暗色模式下有足够的对比度 */
    .post.posts-expand .post-body,
    .page.posts-expand .post-body {
        color: var(--text-color) !important;
    }
    
    /* 确保引用块在暗色模式下可见 */
    .post.posts-expand .post-body blockquote,
    .page.posts-expand .post-body blockquote {
        color: var(--blockquote-color) !important;
    }
    
    /* 确保图片说明文字在暗色模式下可见 */
    .post.posts-expand .post-body figure figcaption,
    .page.posts-expand .post-body figure figcaption {
        color: var(--blockquote-color) !important;
    }
    
    /* 确保图片标题在暗色模式下可见 */
    .image-caption {
        color: var(--blockquote-color) !important;
    }
}

/* 亮色模式下的文字颜色优化（不影响手动暗色模式）*/
@media (prefers-color-scheme: light) {
    /* 仅当未手动选择主题时，跟随系统为亮色 */
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body {
        color: #333 !important;
    }
    
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body p,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body p {
        color: #333 !important;
    }
    
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body h1,
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body h2,
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body h3,
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body h4,
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body h5,
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body h6,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body h1,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body h2,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body h3,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body h4,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body h5,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body h6 {
        color: #222 !important;
    }
    
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body strong,
    :root:not(.theme-dark):not(.theme-light) .post.posts-expand .post-body b,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body strong,
    :root:not(.theme-dark):not(.theme-light) .page.posts-expand .post-body b {
        color: #333 !important;
    }
}

/* 手动切换亮色主题时的效果（不影响暗色）*/
html.theme-light .post.posts-expand .post-body,
body.theme-light .post.posts-expand .post-body,
html.theme-light .page.posts-expand .post-body,
body.theme-light .page.posts-expand .post-body { color: #333 !important; }

/* 手动日间模式下清除徽章滤镜 */
html.theme-light .not-by-ai-sidebar img,
body.theme-light .not-by-ai-sidebar img {
    filter: none !important;
}

html.theme-light .post.posts-expand .post-body p,
body.theme-light .post.posts-expand .post-body p,
html.theme-light .page.posts-expand .post-body p,
body.theme-light .page.posts-expand .post-body p { color: #333 !important; }

html.theme-light .post.posts-expand .post-body h1,
html.theme-light .post.posts-expand .post-body h2,
html.theme-light .post.posts-expand .post-body h3,
html.theme-light .post.posts-expand .post-body h4,
html.theme-light .post.posts-expand .post-body h5,
html.theme-light .post.posts-expand .post-body h6,
body.theme-light .post.posts-expand .post-body h1,
body.theme-light .post.posts-expand .post-body h2,
body.theme-light .post.posts-expand .post-body h3,
body.theme-light .post.posts-expand .post-body h4,
body.theme-light .post.posts-expand .post-body h5,
body.theme-light .post.posts-expand .post-body h6,
html.theme-light .page.posts-expand .post-body h1,
html.theme-light .page.posts-expand .post-body h2,
html.theme-light .page.posts-expand .post-body h3,
html.theme-light .page.posts-expand .post-body h4,
html.theme-light .page.posts-expand .post-body h5,
html.theme-light .page.posts-expand .post-body h6,
body.theme-light .page.posts-expand .post-body h1,
body.theme-light .page.posts-expand .post-body h2,
body.theme-light .page.posts-expand .post-body h3,
body.theme-light .page.posts-expand .post-body h4,
body.theme-light .page.posts-expand .post-body h5,
body.theme-light .page.posts-expand .post-body h6 { color: #222 !important; }

html.theme-light .post.posts-expand .post-body strong,
html.theme-light .post.posts-expand .post-body b,
body.theme-light .post.posts-expand .post-body strong,
body.theme-light .post.posts-expand .post-body b,
html.theme-light .page.posts-expand .post-body strong,
html.theme-light .page.posts-expand .post-body b,
body.theme-light .page.posts-expand .post-body strong,
body.theme-light .page.posts-expand .post-body b { color: #333 !important; }

/* 亮色模式下：文章标题与菜单栏文字颜色加深 */
@media (prefers-color-scheme: light) {
    /* 未手动选择主题（系统为亮色）时生效 */
    :root:not(.theme-dark):not(.theme-light) .posts-expand .post-title-link {
        color: #222 !important;
    }
    :root:not(.theme-dark):not(.theme-light) .posts-expand .post-title-link::before {
        background: #222 !important;
    }
    :root:not(.theme-dark):not(.theme-light) .site-nav .menu .menu-item a,
    :root:not(.theme-dark):not(.theme-light) .menu .menu-item a {
        color: #333 !important;
    }
    :root:not(.theme-dark):not(.theme-light) .site-nav .menu .menu-item a:hover,
    :root:not(.theme-dark):not(.theme-light) .menu .menu-item a:hover {
        color: #222 !important;
    }
}

/* 显式 theme-light：文章标题与菜单栏文字颜色加深 */
html.theme-light .posts-expand .post-title-link,
body.theme-light .posts-expand .post-title-link { color: #222 !important; }
html.theme-light .posts-expand .post-title-link::before,
body.theme-light .posts-expand .post-title-link::before { background: #222 !important; }

html.theme-light .site-nav .menu .menu-item a,
body.theme-light .site-nav .menu .menu-item a,
html.theme-light .menu .menu-item a,
body.theme-light .menu .menu-item a { color: #333 !important; }

html.theme-light .site-nav .menu .menu-item a:hover,
body.theme-light .site-nav .menu .menu-item a:hover,
html.theme-light .menu .menu-item a:hover,
body.theme-light .menu .menu-item a:hover { color: #222 !important; }

/* 深色模式适配 - 系统主题跟随 */
@media (prefers-color-scheme: dark) {
    /* 只在没有自定义主题设置时跟随系统主题 */
    :root:not(.theme-dark):not(.theme-light) .translate-dropdown {
        background: #2d2d2d;
        border-color: #444;
    }
    
    :root:not(.theme-dark):not(.theme-light) .translate-option {
        color: #ddd;
        border-bottom-color: #444;
    }
    
    :root:not(.theme-dark):not(.theme-light) .translate-option:hover {
        background-color: #3a3a3a;
    }
    
    :root:not(.theme-dark):not(.theme-light) .translate-option.active {
        background-color: #1e3a5f;
        color: #66b3ff;
    }
    
    /* 音乐播放器夜间模式适配 - 系统主题跟随 */
    :root:not(.theme-dark):not(.theme-light) .persistent-music-player {
        background: rgba(40, 40, 40, 0.95) !important; /* 深色背景 */
        border: 1px solid rgba(255, 255, 255, 0.1) !important; /* 浅色边框 */
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3) !important; /* 更深的阴影 */
    }
    
    :root:not(.theme-dark):not(.theme-light) .persistent-music-player:hover {
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4) !important; /* 悬停时更深的阴影 */
    }
    
    /* 控制按钮容器夜间模式 - 系统主题跟随 */
    :root:not(.theme-dark):not(.theme-light) .music-controls {
        background: rgba(255, 255, 255, 0.1) !important; /* 浅色背景 */
    }
    
    /* 切换按钮夜间模式 - 系统主题跟随 */
    :root:not(.theme-dark):not(.theme-light) .music-toggle-btn {
        background: rgba(255, 255, 255, 0.2) !important; /* 浅色背景 */
        color: #e0e0e0 !important; /* 浅色文字 */
    }
    
    :root:not(.theme-dark):not(.theme-light) .music-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.3) !important; /* 悬停时更亮 */
    }
    
    /* 最小化按钮夜间模式 - 系统主题跟随 */
    :root:not(.theme-dark):not(.theme-light) .music-minimize-btn {
        background: rgba(255, 255, 255, 0.15) !important; /* 浅色背景 */
        color: #e0e0e0 !important; /* 浅色文字 */
    }
    
    :root:not(.theme-dark):not(.theme-light) .music-minimize-btn:hover {
        background: rgba(255, 255, 255, 0.25) !important; /* 悬停时更亮 */
    }
    
    /* 音乐播放器备用提示夜间模式 - 系统主题跟随 */
    :root:not(.theme-dark):not(.theme-light) .music-fallback {
        background: rgba(255, 255, 255, 0.1) !important; /* 浅色背景 */
    }
    
    :root:not(.theme-dark):not(.theme-light) .music-fallback p {
        color: #ccc !important; /* 浅色文字 */
    }
    
    :root:not(.theme-dark):not(.theme-light) .music-fallback a {
        color: #66b3ff !important; /* 蓝色链接 */
        border-color: #66b3ff !important;
    }
    
    :root:not(.theme-dark):not(.theme-light) .music-fallback a:hover {
        background: #66b3ff !important;
        color: #1a1a1a !important; /* 深色文字在蓝色背景上 */
    }
}

/* 自定义夜间模式适配 */
body.theme-dark,
html.theme-dark {
    /* 手动暗色模式下的徽章样式 */
    .not-by-ai-sidebar img {
        filter: brightness(0.9) !important;
    }
    .translate-dropdown {
        background: #2d2d2d;
        border-color: #444;
    }
    
    .translate-option {
        color: #ddd;
        border-bottom-color: #444;
    }
    
    .translate-option:hover {
        background-color: #3a3a3a;
    }
    
    .translate-option.active {
        background-color: #1e3a5f;
        color: #66b3ff;
    }
    
    /* 音乐播放器夜间模式适配 */
    .persistent-music-player {
        background: rgba(40, 40, 40, 0.95) !important; /* 深色背景 */
        border: 1px solid rgba(255, 255, 255, 0.1) !important; /* 浅色边框 */
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3) !important; /* 更深的阴影 */
    }
    
    .persistent-music-player:hover {
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4) !important; /* 悬停时更深的阴影 */
    }
    
    /* 控制按钮容器夜间模式 */
    .music-controls {
        background: rgba(255, 255, 255, 0.1) !important; /* 浅色背景 */
    }
    
    /* 切换按钮夜间模式 */
    .music-toggle-btn {
        background: rgba(255, 255, 255, 0.2) !important; /* 浅色背景 */
        color: #e0e0e0 !important; /* 浅色文字 */
    }
    
    .music-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.3) !important; /* 悬停时更亮 */
    }
    
    /* 最小化按钮夜间模式 */
    .music-minimize-btn {
        background: rgba(255, 255, 255, 0.15) !important; /* 浅色背景 */
        color: #e0e0e0 !important; /* 浅色文字 */
    }
    
    .music-minimize-btn:hover {
        background: rgba(255, 255, 255, 0.25) !important; /* 悬停时更亮 */
    }
    
    /* 音乐播放器备用提示夜间模式 */
    .music-fallback {
        background: rgba(255, 255, 255, 0.1) !important; /* 浅色背景 */
    }
    
    .music-fallback p {
        color: #ccc !important; /* 浅色文字 */
    }
    
    .music-fallback a {
        color: #66b3ff !important; /* 蓝色链接 */
        border-color: #66b3ff !important;
    }
    
    .music-fallback a:hover {
        background: #66b3ff !important;
        color: #1a1a1a !important; /* 深色文字在蓝色背景上 */
    }
} 