---
title: 谜一样的测试金字塔
date: 2019-12-30 14:10:25
update: 2019-12-30 14:10:25
tags: [测试金字塔, 敏捷]
categories: 项目实践
copyright: true
description: 对测试金字塔的一些总结和思考.
top:
---

<img src="https://i.loli.net/2019/12/30/wVkCrdpXnTN5Pg9.png" alt="题图">

> 作为一个优秀的QA(老脸一红)，最近突然对各种测试相关概念产生了兴趣。比如**BDD**，**测试金字塔**等等。
> 其实这些大佬们提出的概念自然是极好的，但我们知道了这些概念，却无法将它应用到实际工作中，或者应用错了，岂不是辜负了大佬们的分享？对自身也无益。
> 因此，对这些概念我们不仅要知其然，更要知其所以然。不要让这些好理论变成假大空的纸上模型，那今天就来分析一下{% label success@“测试金字塔” %}理论和实际应用:sunglasses:

## 啥是测试金字塔

测试金字塔是按照分层测试的理论，将各种测试方法和测试对象分层，用来解决敏捷开发中测什么和怎么测的问题。一般划分为四层：
<img src="https://i.loli.net/2020/01/02/tsJBZ4Cv6gKRGFo.png" alt="测试金字塔">

### 单元测试
根据单元测试实现effort小，运行速度快，维护方便的特点，把它放在测试金字塔的最底层，所以它的数量和覆盖率也应当是所有测试中最多的。
### 服务测试
包括集成测试/组件测试/接口测试/契约测试。相对单元测试粒度较粗，所以将它放在第三层。
大佬说：{% label info@服务测试是一个难以掌握的术语，所以很多开发人员完全忽略了这一层。在单页应用框架（如 react，angular，ember.js 等）的时代，UI 测试显然不必位于金字塔的最高层，因为完全可以用这些框架对 UI 进行单元测试。 %}
### UI测试
也叫端到端测试，由于实现和维护成本较高，所以在第二层。
### 手工测试
第一层，包括必要的手工测试，探索测试和验收测试。有时候，一些功能无法用自动化进行测试，比如页面的美观性可用性等，只能手工测试。而且尽管有单元测试和自动化测试在前，但依然无法保证覆盖所有边缘情况。此时，一些探索测试是非常有必要的。

## 一些需要注意的点
### 不要纠结各种测试术语
比如有些人说集成测试就是API测试，UI测试就是端到端测试，有人却说这些概念都是不同的。有人喜欢把集成测试叫组件测试等等。这就会导致同一个东西有很多的名字。容易陷入“你说的黑是什么黑，他说的白是什么白”这种无意义的牛角尖中。这个时候，大佬说的话，就很好:clap:：
{% note info %}
各种测试术语并无绝对的对与错。软件开发社区至今也没法给出关于测试术语的明确定义。
术语含义本身有模糊性，不必孜孜不倦于其中。你认为的集成测试，可能和其他公司的人的认知也不同，这也没问题。
找到适合你和你团队的术语，这就足够了。
{% endnote %}
### 时刻维护金字塔形状，避免测试重复
首先要避免在金字塔不同层级进行重复测试，因为浪费时间、浪费金钱:joy:
在高层次测试发现的问题，想办法写低层测试去覆盖它，尽可能把测试往金字塔下层迁移，维护金字塔形状。
### 整理测试代码
重构是个好概念，希望你也知道:satisfied:。
测试代码加tag, 根据功能分支分类。
运用Given,When,Then口诀写测试，一些BDD的测试工具就很好用，比如 [Cucumber](https://cucumber.io/)。

## 测试金字塔是一成不变的吗

{% label primary@答案是否定的。 %}

在实际项目中，上面的三层金字塔模型也许过于简单和概括化了。但它却足够简洁，上述三种测试方法也确实是目前最主流的。所以，可以根据实际情况建立自己的金字塔模型，比如可以再细分几层，把里面的测试方法改成别的等等。但一定要遵守这两条法则：
- 按照测试粒度分层
- 层次越高，你写的测试应该越少


## 参考文章

<span id="inline-toc">1.</span>[ThoughtWorks洞见-测试金字塔实战](https://insights.thoughtworks.cn/practical-test-pyramid/)